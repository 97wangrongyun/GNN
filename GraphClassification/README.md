# SAGPool 图分类

## 简介

在[之前的文章](https://blog.csdn.net/zhouchen1998/category_10528560.html)中，我主要提及了节点级别的任务，这种任务的特点是不断对节点的特征进行聚合，每次聚合各个节点都会聚集邻居的信息，但是，**图的结构是不会变化的**。图分类则是一个图层面的任务，与节点层面的任务不同，它需要的是图数据的全局信息，既包括图的结构信息，也包括每个节点的属性信息。图分类任务说来也简单，给定多张图及其标签，要求学习一个由图到相应标签的图分类模型，模型的重点是如何学习一个较好的全图表示向量。

## SAGPool算法

图分类任务和视觉图像的分类任务类似，都需要对全局的信息进行融合学习。不妨回顾一下CNN中的处理思路，在卷积神经网络中，我们通常利用层次化池化来逐渐提取全局信息。得益于图像的栅格结构，池化操作能够非常简单高效地的实现并用于高阶信息的提取。然而，非规则的图结构数据使得池化的设计变得比较困难。

SAGPool（Self-Attention Pooling，自注意力池化）是层次化池化的一种实现，它的思路是通过图卷积从图中自适应学习到节点的重要性，然后利用TopK机制进行节点丢弃。

具体来看，使用GCN为每个节点赋予重要性得分，如下式所示。其中$\sigma$表示激活函数，$\tilde{A}$表示增加了自连接的邻接矩阵，$X$表示节点特征，$\Theta_{a t t} \in R^{N\times 1}$表示权重参数

$$
Z=\sigma\left(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} X \Theta_{a t t}\right)
$$

感兴趣查看[原论文](https://arxiv.org/abs/1904.08082)
